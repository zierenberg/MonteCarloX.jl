<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Importance Sampling Algorithms · MonteCarloX</title><meta name="title" content="Importance Sampling Algorithms · MonteCarloX"/><meta property="og:title" content="Importance Sampling Algorithms · MonteCarloX"/><meta property="twitter:title" content="Importance Sampling Algorithms · MonteCarloX"/><meta name="description" content="Documentation for MonteCarloX."/><meta property="og:description" content="Documentation for MonteCarloX."/><meta property="twitter:description" content="Documentation for MonteCarloX."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MonteCarloX</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Getting Started</a></li><li><a class="tocitem" href="../framework/">Framework</a></li><li><a class="tocitem" href="../core_abstractions/">Core Abstractions</a></li><li><a class="tocitem" href="../weights/">Weights</a></li><li class="is-active"><a class="tocitem" href>Importance Sampling Algorithms</a><ul class="internal"><li><a class="tocitem" href="#Metropolis-family-algorithms"><span>Metropolis-family algorithms</span></a></li><li><a class="tocitem" href="#Heat-bath-updates"><span>Heat-bath updates</span></a></li><li><a class="tocitem" href="#Generalized-ensembles"><span>Generalized ensembles</span></a></li><li><a class="tocitem" href="#API-reference"><span>API reference</span></a></li></ul></li><li><a class="tocitem" href="../continuous_time_sampling_algorithms/">Continuous-Time Sampling Algorithms</a></li><li><a class="tocitem" href="../measurements/">Measurements</a></li><li><a class="tocitem" href="../systems/">Systems</a></li><li><a class="tocitem" href="../examples/">Worked Examples</a></li><li><a class="tocitem" href="../helper/">Helper</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Importance Sampling Algorithms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Importance Sampling Algorithms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/zierenberg/MonteCarloX.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/zierenberg/MonteCarloX.jl/blob/main/docs/src/importance_sampling_algorithms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Importance-Sampling-Algorithms"><a class="docs-heading-anchor" href="#Importance-Sampling-Algorithms">Importance Sampling Algorithms</a><a id="Importance-Sampling-Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Importance-Sampling-Algorithms" title="Permalink"></a></h1><p>Importance-sampling workflows in MonteCarloX use accept/reject-style updates to target a specified distribution. You combine:</p><ul><li>a system that defines state and local updates,</li><li>a log weight (<code>BoltzmannLogWeight</code> or tabulated variants),</li><li>an algorithm that accepts/rejects proposals.</li></ul><h2 id="Metropolis-family-algorithms"><a class="docs-heading-anchor" href="#Metropolis-family-algorithms">Metropolis-family algorithms</a><a id="Metropolis-family-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Metropolis-family-algorithms" title="Permalink"></a></h2><p><code>Metropolis</code> and <code>Glauber</code> share the same log-ratio interface but use different acceptance rules.</p><p>Typical model-side update methods compute a local energy change and call <code>accept!</code> through algorithm helpers.</p><pre><code class="language-julia hljs">using Random
using MonteCarloX
using SpinSystems

rng = MersenneTwister(42)
sys = Ising([16, 16], J=1, periodic=true)
init!(sys, :random, rng=rng)

alg = Metropolis(rng; β=0.4)

for _ in 1:50_000
    spin_flip!(sys, alg)
end

println(&quot;acceptance = &quot;, acceptance_rate(alg))</code></pre><h2 id="Heat-bath-updates"><a class="docs-heading-anchor" href="#Heat-bath-updates">Heat-bath updates</a><a id="Heat-bath-updates-1"></a><a class="docs-heading-anchor-permalink" href="#Heat-bath-updates" title="Permalink"></a></h2><p><code>HeatBath</code> uses conditional local probabilities instead of accept/reject logic. This can improve mixing for some model classes.</p><h2 id="Generalized-ensembles"><a class="docs-heading-anchor" href="#Generalized-ensembles">Generalized ensembles</a><a id="Generalized-ensembles-1"></a><a class="docs-heading-anchor-permalink" href="#Generalized-ensembles" title="Permalink"></a></h2><ul><li><code>Multicanonical</code> targets flat-histogram-like exploration by evolving a tabulated log weight.</li><li><code>WangLandau</code> iteratively updates density-of-states estimates and refinement parameter <code>f</code>.</li></ul><pre><code class="language-julia hljs">using Random
using MonteCarloX

rng = MersenneTwister(7)
alg = WangLandau(rng)

# update_weight! and update_f! are called in your simulation loop</code></pre><h2 id="API-reference"><a class="docs-heading-anchor" href="#API-reference">API reference</a><a id="API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="MonteCarloX.AbstractImportanceSampling"><a class="docstring-binding" href="#MonteCarloX.AbstractImportanceSampling"><code>MonteCarloX.AbstractImportanceSampling</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractImportanceSampling &lt;: AbstractAlgorithm</code></pre><p>Base type for importance sampling algorithms (Metropolis, Heat Bath, etc.).</p><p>Importance sampling algorithms:</p><ul><li>Use accept/reject steps based on log weight ratios</li><li>Track acceptance statistics</li><li>Include an RNG and a log weight function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/importance_sampling.jl#L3-L12">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.AbstractGeneralizedEnsemble"><a class="docstring-binding" href="#MonteCarloX.AbstractGeneralizedEnsemble"><code>MonteCarloX.AbstractGeneralizedEnsemble</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractGeneralizedEnsemble &lt;: AbstractImportanceSampling</code></pre><p>Base type for generalized-ensemble samplers (e.g. multicanonical, Wang-Landau).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/importance_sampling.jl#L15-L19">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.AbstractMetropolis"><a class="docstring-binding" href="#MonteCarloX.AbstractMetropolis"><code>MonteCarloX.AbstractMetropolis</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractMetropolis &lt;: AbstractImportanceSampling</code></pre><p>Base type for Metropolis-family samplers where acceptance is naturally computed from a local state difference (e.g. ΔE).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/importance_sampling.jl#L22-L27">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.AbstractHeatBath"><a class="docstring-binding" href="#MonteCarloX.AbstractHeatBath"><code>MonteCarloX.AbstractHeatBath</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractHeatBath &lt;: AbstractAlgorithm</code></pre><p>Base type for heat-bath style samplers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/importance_sampling.jl#L30-L34">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.Metropolis"><a class="docstring-binding" href="#MonteCarloX.Metropolis"><code>MonteCarloX.Metropolis</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Metropolis &lt;: AbstractImportanceSampling</code></pre><p>Metropolis algorithm for importance sampling.</p><p>The Metropolis algorithm samples from a probability distribution  proportional to exp(log_weight) using an accept/reject criterion.</p><p><strong>Fields</strong></p><ul><li><code>rng::AbstractRNG</code>: Random number generator</li><li><code>logweight::Union{AbstractLogWeight, Function}</code>: Log weight function</li><li><code>steps::Int</code>: Total number of steps attempted</li><li><code>accepted::Int</code>: Number of accepted steps</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Create with Boltzmann weight
alg = Metropolis(Random.default_rng(), β=2.0)

# Create with custom log weight function
alg = Metropolis(Random.default_rng(), E -&gt; -2.0 * sum(E))

# Create with a weight object
logweight = BoltzmannLogWeight(1.5)
alg = Metropolis(Random.default_rng(), logweight)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/metropolis.jl#L5-L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.Glauber"><a class="docstring-binding" href="#MonteCarloX.Glauber"><code>MonteCarloX.Glauber</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Glauber &lt;: AbstractMetropolis</code></pre><p>Glauber sampler with logistic acceptance rule.</p><p>Uses the same proposal interface and log-ratio as Metropolis-family algorithms, but acceptance is:</p><pre><code class="nohighlight hljs">p_accept = 1 / (1 + exp(-log_ratio))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/metropolis.jl#L67-L76">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.HeatBath"><a class="docstring-binding" href="#MonteCarloX.HeatBath"><code>MonteCarloX.HeatBath</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">HeatBath &lt;: AbstractHeatBath</code></pre><p>Heat-bath sampler parameters.</p><p>For Ising-like systems, updates draw directly from the local conditional probability using inverse temperature <code>β</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/heat_bath.jl#L3-L10">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.accept!"><a class="docstring-binding" href="#MonteCarloX.accept!"><code>MonteCarloX.accept!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">accept!(alg::AbstractImportanceSampling, x_new, x_old)
accept!(alg::AbstractMetropolis, delta_x)</code></pre><p>Evaluate acceptance criterion for importance sampling with differences.</p><p>Updates step and acceptance counters in the algorithm. Returns true if the move is accepted based on the Metropolis criterion:</p><ul><li>Accept if log_ratio &gt; 0 (new state has higher weight)</li><li>Accept with probability exp(log_ratio) otherwise</li></ul><p>This is the core accept/reject step used by all importance sampling algorithms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/importance_sampling.jl#L37-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.acceptance_rate"><a class="docstring-binding" href="#MonteCarloX.acceptance_rate"><code>MonteCarloX.acceptance_rate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">acceptance_rate(alg::AbstractImportanceSampling)</code></pre><p>Calculate the acceptance rate of the algorithm.</p><p>Returns the fraction of accepted moves: accepted/steps. Returns 0.0 if no steps have been attempted yet.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/importance_sampling.jl#L66-L73">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.reset!-Tuple{AbstractImportanceSampling}"><a class="docstring-binding" href="#MonteCarloX.reset!-Tuple{AbstractImportanceSampling}"><code>MonteCarloX.reset!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">reset!(alg::AbstractImportanceSampling)</code></pre><p>Reset step and acceptance counters to zero.</p><p>Useful when you want to measure acceptance rate for a specific run phase without previous history.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/importance_sampling.jl#L77-L84">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.Multicanonical"><a class="docstring-binding" href="#MonteCarloX.Multicanonical"><code>MonteCarloX.Multicanonical</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Multicanonical &lt;: AbstractImportanceSampling</code></pre><p>Generalized-ensemble importance sampling algorithm.</p><p>The algorithm tracks standard acceptance statistics and stores a tabulated log-weight estimate.</p><p>Notation used here:</p><ul><li><code>Ω(x)</code>: density of states</li><li><code>S(x) = log Ω(x)</code>: microcanonical entropy estimate</li><li><code>logWeight(x) = -S(x)</code> stored in <code>alg.logweight</code></li></ul><p>TODO: </p><ul><li>implement check that new state is within the domain of the log-weight table and define behavior if not (e.g. reject move)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/multicanonical.jl#L3-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.WangLandau"><a class="docstring-binding" href="#MonteCarloX.WangLandau"><code>MonteCarloX.WangLandau</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">WangLandau &lt;: AbstractImportanceSampling</code></pre><p>Wang-Landau generalized-ensemble sampler.</p><p>Notation used here:</p><ul><li><code>g(E)</code>: density of states estimate</li><li><code>S(E) = log g(E)</code>: entropy estimate</li><li><code>logWeight(E) = S(E)</code> stored in <code>alg.logweight</code></li><li><code>logf = log(f)</code>: logarithmic modification factor</li></ul><p>Each visit to an energy bin <code>E_i</code> applies the local update <code>S(E_i) &lt;- S(E_i) + logf</code>. In this API convention this appears as <code>alg.logweight[E_i] -= logf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/wang_landau.jl#L5-L20">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.update_weight!"><a class="docstring-binding" href="#MonteCarloX.update_weight!"><code>MonteCarloX.update_weight!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">update_weights!(
alg::Multicanonical,
mode::Symbol = :simple,</code></pre><p>)</p><p>Update multicanonical log-weights from a sampling histogram in-place.</p><p>Currently implemented mode:</p><ul><li><code>:simple</code>: for visited bins, perform   <code>logWeight(E) &lt;- logWeight(E) - log(H(E))</code>.</li></ul><p>This mutates <code>alg.logweight</code> and returns <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/multicanonical.jl#L55-L68">source</a></section><section><div><pre><code class="language-julia hljs">update_weight!(alg::WangLandau, x)</code></pre><p>Apply one local Wang-Landau update at <code>x</code>:</p><ul><li><code>alg.logweight[x] -= alg.logf</code></li></ul><p>Mutates in place and returns <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/wang_landau.jl#L48-L55">source</a></section></details></article><article><details class="docstring" open="true"><summary id="MonteCarloX.update_f!"><a class="docstring-binding" href="#MonteCarloX.update_f!"><code>MonteCarloX.update_f!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">update_f!(alg::WangLandau)</code></pre><p>Update Wang-Landau schedule in-place with <code>logf &lt;- 0.5 * logf</code> (equivalent to <code>f &lt;- sqrt(f)</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/zierenberg/MonteCarloX.jl/blob/b3dcadce685812da82cbbaf1c8691bc008bcd105/src/algorithms/wang_landau.jl#L70-L75">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../weights/">« Weights</a><a class="docs-footer-nextpage" href="../continuous_time_sampling_algorithms/">Continuous-Time Sampling Algorithms »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Monday 23 February 2026 21:10">Monday 23 February 2026</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
